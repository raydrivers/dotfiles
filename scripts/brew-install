#!/bin/bash

set -e

export HOMEBREW_NO_AUTO_UPDATE=1
export HOMEBREW_NO_INSTALL_CLEANUP=1
export HOMEBREW_NO_INSTALLED_DEPENDENTS_CHECK=1
export HOMEBREW_NO_ENV_HINTS=1

GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

if [[ $# -eq 0 ]]; then
    echo "Usage: brew-install <package> [package...]"
    exit 1
fi

installed=$(brew list --formula -1 2>/dev/null)
missing=()

for pkg in "$@"; do
    if echo "$installed" | grep -qx "$pkg"; then
        echo -e "${GREEN}âœ“${NC} $pkg (already installed)"
    else
        missing+=("$pkg")
    fi
done

if [[ ${#missing[@]} -eq 0 ]]; then
    echo -e "${GREEN}All packages already installed${NC}"
    exit 0
fi

echo -e "${YELLOW}Installing: ${missing[*]}${NC}"
brew install "${missing[@]}"
