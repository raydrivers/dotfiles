#!/bin/bash

wt_get_bare_repo() {
    local bare_repo
    bare_repo=$(git rev-parse --git-common-dir 2>/dev/null)
    
    if [[ ! -d "$bare_repo" ]]; then
        echo "Error: Not in a git repository" >&2
        return 1
    fi
    
    if [[ ! "$bare_repo" =~ \.git$ ]] && [[ ! -f "$bare_repo/HEAD" ]]; then
        echo "Error: This command requires a bare repository" >&2
        return 1
    fi
    
    echo "$bare_repo"
}

wt_get_dev_dir() {
    local bare_repo
    bare_repo=$(wt_get_bare_repo) || return 1
    echo "$bare_repo/dev"
}

wt_ensure_dev_dir() {
    local dev_dir
    dev_dir=$(wt_get_dev_dir) || return 1
    mkdir -p "$dev_dir"
    echo "$dev_dir"
}

wt_clean_branch_path() {
    local branch="$1"
    echo "${branch#*/}"
}

